"use strict";(self.webpackChunkwaxdevelopers=self.webpackChunkwaxdevelopers||[]).push([[4550],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=d(n),h=r,m=c["".concat(l,".").concat(h)]||c[h]||u[h]||o;return n?a.createElement(m,s(s({ref:t},p),{},{components:n})):a.createElement(m,s({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,s=new Array(o);s[0]=h;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[c]="string"==typeof e?e:r,s[1]=i;for(var d=2;d<o;d++)s[d]=n[d];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},8646:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var a=n(7462),r=(n(7294),n(3905));const o={title:"API Full/Partial Archive nodes",nav_order:141,layout:"default",parent:"WAX Infrastructure Guides","lang-ref":"API Full/Partial Archive nodes",lang:"en"},s=void 0,i={unversionedId:"wax-infrastructure/api-archive-guide",id:"wax-infrastructure/api-archive-guide",title:"API Full/Partial Archive nodes",description:'WAX is a distributed network of computers running software (known as nodes) that can verify blocks and transaction data. You need WAX software, on your server to "run" a node. "Node" refers to running WAX software. WAX software verifies all transactions in each block, keeping the network secure and the data accurate.',source:"@site/docs/wax-infrastructure/api-archive-guide.md",sourceDirName:"wax-infrastructure",slug:"/wax-infrastructure/api-archive-guide",permalink:"/waxdevelopers_test/docs/wax-infrastructure/api-archive-guide",draft:!1,editUrl:"https://github.com/wax-office-of-inspector-general/wax-developer/tree/main/docs/wax-infrastructure/api-archive-guide.md",tags:[],version:"current",frontMatter:{title:"API Full/Partial Archive nodes",nav_order:141,layout:"default",parent:"WAX Infrastructure Guides","lang-ref":"API Full/Partial Archive nodes",lang:"en"},sidebar:"tutorialSidebar",previous:{title:"WAX Infrastructure Guide",permalink:"/waxdevelopers_test/docs/category/wax-infrastructure-guide"},next:{title:"Atomic Assets/Market API",permalink:"/waxdevelopers_test/docs/wax-infrastructure/atomic-api-guide"}},l={},d=[{value:"Credits:",id:"credits",level:4},{value:"Pre-requisites/Requirements:",id:"pre-requisitesrequirements",level:3},{value:"Bare-Metal Infra providers:",id:"bare-metal-infra-providers",level:4},{value:"Setup and Installation:",id:"setup-and-installation",level:3},{value:"1. Update the default pacakages and install new ones",id:"1-update-the-default-pacakages-and-install-new-ones",level:5},{value:"2. For better CPU performance:",id:"2-for-better-cpu-performance",level:5},{value:"3. Create disk partitions",id:"3-create-disk-partitions",level:5},{value:"4. Increase the Swap size as its usually small on the servers from Hetzner and Leaseweb.",id:"4-increase-the-swap-size-as-its-usually-small-on-the-servers-from-hetzner-and-leaseweb",level:5},{value:"5. Create ZFS storage pool based on your requirements with zraid or mirror etc modes. A good resource to do calculations on disk sizes: http://www.raidz-calculator.com/",id:"5-create-zfs-storage-pool-based-on-your-requirements-with-zraid-or-mirror-etc-modes-a-good-resource-to-do-calculations-on-disk-sizes-httpwwwraidz-calculatorcom",level:5},{value:"6. Setup NTP to ensure the clocks are in sync",id:"6-setup-ntp-to-ensure-the-clocks-are-in-sync",level:5},{value:"7. Setup Stack Limits and Openfiles on your server",id:"7-setup-stack-limits-and-openfiles-on-your-server",level:5},{value:"8. Build and Configure the Software:",id:"8-build-and-configure-the-software",level:5},{value:"9. Running the Node:",id:"9-running-the-node",level:5},{value:"Running and managing nodeos using scripts:",id:"running-and-managing-nodeos-using-scripts",level:6}],p={toc:d},c="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(c,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,'WAX is a distributed network of computers running software (known as nodes) that can verify blocks and transaction data. You need WAX software, on your server to "run" a node. "Node" refers to running WAX software. WAX software verifies all transactions in each block, keeping the network secure and the data accurate. '),(0,r.kt)("p",null,"If you want to run your own node, you should understand that there are different types of node that consume and store data differently. In fact, WAX Software can be run in 3 different types of modes - peer, api, archive nodes. These setups also determine how quickly the node can get the most up-to-date information."),(0,r.kt)("p",null,"Archive nodes can be partial or full based on how they are started. These nodes contain the blocks, state history of the blockchain. Partial archive nodes are mainly started from snapshots so they don't contain full history of the blockchain but only have the history from a specific block."),(0,r.kt)("p",null,"Archive nodes are also referred as State-History or Ship nodes."),(0,r.kt)("h4",{id:"credits"},"Credits:"),(0,r.kt)("p",null,"@cc32d9, Eosphere Team"),(0,r.kt)("h3",{id:"pre-requisitesrequirements"},"Pre-requisites/Requirements:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Full State-History node Hardware(recommended specs):")," 4Ghz+ CPU speed, 128GB RAM, 8TB SSD or NvME ","[For a partial state-history, you can have lower specs as its started from a snapshot]"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Dependencies:")," v2.0.13wax01(WAX Software recommended version)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"OS:")," Ubuntu18.04 (recommended)")),(0,r.kt)("h4",{id:"bare-metal-infra-providers"},"Bare-Metal Infra providers:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.hetzner.com/dedicated-rootserver",title:"Hetzner"},"Hetzner")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://www.leaseweb.us/dedicated-servers",title:"Leaseweb"},"Leaseweb"))),(0,r.kt)("h3",{id:"setup-and-installation"},"Setup and Installation:"),(0,r.kt)("p",null,"After securing the servers and setting up the boot configuration and appropriate RAID modes, you can login to the server and follow the next commands below: "),(0,r.kt)("p",null,"[Recommendation - Only setup root partition in Raid1 or Raid5 modes for now. We shall partition the disks later on after the boot and allocate them to a ZFS pool]"),(0,r.kt)("h5",{id:"1-update-the-default-pacakages-and-install-new-ones"},"1. Update the default pacakages and install new ones"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"apt-get update && apt-get install -y vim htop aptitude git lxc-utils zfsutils-linux netfilter-persistent sysstat ntp gpg screen zstd\n")),(0,r.kt)("h5",{id:"2-for-better-cpu-performance"},"2. For better CPU performance:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"apt-get install -y cpufrequtils\necho 'GOVERNOR=\"performance\"' | tee /etc/default/cpufrequtils\nsystemctl disable ondemand\nsystemctl restart cpufrequtils\n")),(0,r.kt)("h5",{id:"3-create-disk-partitions"},"3. Create disk partitions"),(0,r.kt)("p",null,"First step is to determine the disks and their names using the commands below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"fdisk -l\n")),(0,r.kt)("p",null,"Now after identifying the disk names, let's partition them using the example command below, we need to create two partitions One for Swap and One for ZFS storage pool."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cfdisk /dev/nvme0n1\n")),(0,r.kt)("p",null,"Do the above for all the disks on your server."),(0,r.kt)("h5",{id:"4-increase-the-swap-size-as-its-usually-small-on-the-servers-from-hetzner-and-leaseweb"},"4. Increase the Swap size as its usually small on the servers from Hetzner and Leaseweb."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mkswap /dev/nvme0n1p5\nmkswap /dev/nvme1n1p5\n")),(0,r.kt)("p",null,"Now let's add the Swap pools to the System's FileSystem table by editing the file below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cat >>/etc/fstab <<'EOT'\n/dev/nvme0n1p5     none            swap            defaults,pri=-2 0 0\n/dev/nvme1n1p5     none            swap            defaults,pri=-2 0 0\n/dev/nvme2n1p5     none            swap            defaults,pri=-2 0 0\nEOT\n")),(0,r.kt)("p",null,"After editing, let's enable the newly added Swap pool using the command below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"swapon -a\n")),(0,r.kt)("h5",{id:"5-create-zfs-storage-pool-based-on-your-requirements-with-zraid-or-mirror-etc-modes-a-good-resource-to-do-calculations-on-disk-sizes-httpwwwraidz-calculatorcom"},"5. Create ZFS storage pool based on your requirements with zraid or mirror etc modes. A good resource to do calculations on disk sizes: ",(0,r.kt)("a",{parentName:"h5",href:"http://www.raidz-calculator.com/"},"http://www.raidz-calculator.com/")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"zpool create -o ashift=12 zfast raidz /dev/nvme0n1p6 /dev/nvme1n1p6 /dev/nvme2n1p6 [--\x3e adopt the partition names accordingly]\n#Disable ZFS access time Updates\n> zfs set atime=off zfast\n#Set ARC to only cache metadata\n> sudo zfs set primarycache=all datavolume\n#Enable LZ4 compression\nzfs set compression=lz4 zfast\nzfs create -o mountpoint=/home zfast/home [--\x3eCreates mountpoint]\n")),(0,r.kt)("h5",{id:"6-setup-ntp-to-ensure-the-clocks-are-in-sync"},"6. Setup NTP to ensure the clocks are in sync"),(0,r.kt)("p",null,"It is important to have this as a peer-to-peer blockchain network to have synchronised time across all nodes. Chrony is an excellent NTP client and is quite suitable for the needs of WAX Mainnet."),(0,r.kt)("p",null,"Install, configure and verify as below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"#Install Chrony\n> sudo apt install chrony\n#If necessary manually add local peers, these are AU servers\n> sudo nano /etc/chrony/chrony.conf\n\nserver 0.pool.ntp.org\nserver 1.pool.ntp.org\nserver 2.pool.ntp.org\nserver 3.pool.ntp.org\n#Restart Chrony\n> sudo /etc/init.d/chrony restart\n#Verify\n> chronyc sources -v\n> chronyc tracking\n#Set your local timezone if necessary\n> sudo timedatectl set-timezone Europe/Stockholm\n")),(0,r.kt)("h5",{id:"7-setup-stack-limits-and-openfiles-on-your-server"},"7. Setup Stack Limits and Openfiles on your server"),(0,r.kt)("p",null,"The default Stack Limits and Number of Open Files in Ubuntu 18.04 should be increased to support the WAX software memory requirements and the number of API requests on a Production Mainnet Node."),(0,r.kt)("p",null,"Configure and verify the raised limits as below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"> sudo nano /etc/systemd/system.conf\n#Append the following configuration\nDefaultLimitNOFILE=64000 \nDefaultLimitSTACK=65536000\n#Restart server and verify\n> ulimit -a\n")),(0,r.kt)("hr",null),(0,r.kt)("p",null,"Now that we have setup the server and disk storage in a good way, let's go ahead with the next steps to build and setup the State-History nodes."),(0,r.kt)("h5",{id:"8-build-and-configure-the-software"},"8. Build and Configure the Software:"),(0,r.kt)("p",null,"WAX software is an open-source modified version of Antelope software to suit the needs of the WAX Network.Currently the WAX accepted software build and version is v2.0.13wax01 created by ",(0,r.kt)("a",{parentName:"p",href:"https://cc32d9.medium.com/"},"cc32d9")," who is a member of the ",(0,r.kt)("a",{parentName:"p",href:"https://eosamsterdam.net/"},"EOS Amsterdam Guild")),(0,r.kt)("p",null,"The latest waxbuild tag is always available on the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/worldwide-asset-exchange/wax-blockchain/tags"},"WAX Github"),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Manual Build")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cd ~\ngit clone https://github.com/worldwide-asset-exchange/wax-blockchain.git\ncd wax-blockchain\ngit checkout v2.0.13wax01\ngit submodule update --init --recursive\ncd scripts > ./eosio_build.sh -P./eosio_install.sh \n#If you want to install. Binaries are in ~/wax2.0/build/programs\n")),(0,r.kt)("p",null,"As the -P option is used on the build script this may take some time to compile as it will build with pinned clang and libcxx"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Pre-Build Packages"),"\nWAX Sweden team offers Pre-Build packages that can be easily installed. You can find them here: ",(0,r.kt)("a",{parentName:"p",href:"https://eosswedenorg.github.io/apt/wax"},"https://eosswedenorg.github.io/apt/wax"),"\nPlease visit the above link and follow the provided instructions."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Configuration")),(0,r.kt)("p",null,"Now that WAX Software is installed, let's go ahead and configure the state-history setup:"),(0,r.kt)("p",null,"There are different components in the software like nodeos, cleos, keosd etc. ",(0,r.kt)("strong",{parentName:"p"},"nodeos")," is the core service which runs the protocol and is used across all the nodes. The configuration of nodeos is done using config.ini file. The settings of this file determine what kind of node you are running."),(0,r.kt)("p",null,"Follow the below steps to config the nodeos:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"mkdir /home/data\nmkdir /home/conf\n\ncd /home/data\nnano config.ini\n")),(0,r.kt)("p",null,"Below is an example ",(0,r.kt)("strong",{parentName:"p"},"mainnnet")," config.ini file which is customized to setup state-history node, you can just copy and paste:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"wasm-runtime = eos-vm-jit\neos-vm-oc-compile-threads = 4\neos-vm-oc-enable = true\nread-mode = head\ncontracts-console = true\n\nchain-state-db-size-mb = 131072\nchain-state-db-guard-size-mb = 1024\nchain-threads = 4\nhttp-threads = 8\n\n# Safely shut down node when less free space\nchain-state-db-guard-size-mb = 128\nreversible-blocks-db-guard-size-mb = 2\n\ndisable-subjective-p2p-billing = false\nhttp-server-address = 0.0.0.0:8888\naccess-control-allow-origin = *\naccess-control-allow-headers = Origin, X-Requested-With, Content-Type, Accept\nhttp-max-response-time-ms = 100\nverbose-http-errors = true\nhttp-validate-host = false\n\n#Peering endpoint config\np2p-listen-endpoint = 0.0.0.0:9876\np2p-server-address = 0.0.0.0:9876\n\n# State History Settings (need add to start params --disable-replay-opts )\nplugin = eosio::state_history_plugin\nstate-history-dir = state-history\ntrace-history = true\nchain-state-history = true\nstate-history-endpoint = 0.0.0.0:8080\n\nallowed-connection = any\n\nmax-clients = 150\nconnection-cleanup-period = 30\nsync-fetch-span = 2000\nenable-account-queries = true\n\n# Core Blockchain plugins\nplugin = eosio::chain_plugin\nplugin = eosio::chain_api_plugin\nplugin = eosio::http_plugin\n\n#Peers list - Refer this link for mainnet latest peers: https://validate.eosnation.io/wax/reports/config.html\n\n# alohaeosprod: US, Oregon\np2p-peer-address = peer.wax.alohaeos.com:9876\n\n# blacklusionx: DE, Germany\np2p-peer-address = peer1.wax.blacklusion.io:4646\n\n# blacklusionx: DE, Germany\np2p-peer-address = peer1-emea.wax.blacklusion.io:4646\n\n# bp.wecan: US, NewYork\np2p-peer-address = seed3-wax-mainnet.wecan.dev:14998\n\n# dapplica: DE, Germany-Finland\np2p-peer-address = wax.dapplica.io:9876\n\n# eosarabianet: DE, Munich\np2p-peer-address = p2p-wax.eosarabia.net:9876\n\n# eosdacserver: GB, United Kingdom\np2p-peer-address = wax-p2p.eosdac.io:29876\n\n# eosdublinwow: FI, Finland\np2p-peer-address = wax.p2p.eosdublin.io:9876\n\n# eoseouldotio: JP, Seoul\np2p-peer-address = p2p.wax.eoseoul.io:29876\n\n# eosphereiobp: AU, Sydney\np2p-peer-address = peer2-wax.eosphere.io:9876\n\n# guild.nefty: FI, Finland\np2p-peer-address = p2p-node2.neftyblocks.com:9876\n\n# ledgerwiseio: FI, LB\np2p-peer-address = waxp2p.ledgerwise.io:21877\n\n# waxhiveguild: FI, Finnland\np2p-peer-address = peer1.hivebp.io:9876\n")),(0,r.kt)("p",null,"If you are starting the node from the 1st block, then you also need to have ",(0,r.kt)("strong",{parentName:"p"},"genesis.json")," file as well:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cd /home/conf\nnano genesis.json\n")),(0,r.kt)("p",null,"Add the following config to the genesis.json file. This is for the ",(0,r.kt)("strong",{parentName:"p"},"WAX Mainnet"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n  "initial_timestamp": "2019-06-05T12:00:00.000",\n  "initial_key": "EOS8i2pkwtv2JmdYWNJdcy5BcJ7wCE5q6mpE1hwT25HdgHMzeRday",\n  "initial_configuration": {\n    "max_block_net_usage": 1048576,\n    "target_block_net_usage_pct": 1000,\n    "max_transaction_net_usage": 524288,\n    "base_per_transaction_net_usage": 12,\n    "net_usage_leeway": 500,\n    "context_free_discount_net_usage_num": 20,\n    "context_free_discount_net_usage_den": 100,\n    "max_block_cpu_usage": 500000,\n    "target_block_cpu_usage_pct": 2000,\n    "max_transaction_cpu_usage": 150000,\n    "min_transaction_cpu_usage": 100,\n    "max_transaction_lifetime": 3600,\n    "deferred_trx_expiration_window": 600,\n    "max_transaction_delay": 3888000,\n    "max_inline_action_size": 4096,\n    "max_inline_action_depth": 4,\n    "max_authority_depth": 6\n  }\n}\n')),(0,r.kt)("p",null,"For ",(0,r.kt)("strong",{parentName:"p"},"WAX Testnet"),", add the following config to the genesis.json file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'{\n  "initial_timestamp": "2019-12-06T06:06:06.000",\n  "initial_key": "EOS7PmWAXLBaqCzSgbq8cyr2HFztQpwBpXk3djBJA8fyoyUnYM37q",\n  "initial_configuration": {\n    "max_block_net_usage": 1048576,\n    "target_block_net_usage_pct": 1000,\n    "max_transaction_net_usage": 524288,\n    "base_per_transaction_net_usage": 12,\n    "net_usage_leeway": 500,\n    "context_free_discount_net_usage_num": 20,\n    "context_free_discount_net_usage_den": 100,\n    "max_block_cpu_usage": 200000,\n    "target_block_cpu_usage_pct": 2500,\n    "max_transaction_cpu_usage": 150000,\n    "min_transaction_cpu_usage": 100,\n    "max_transaction_lifetime": 3600,\n    "deferred_trx_expiration_window": 600,\n    "max_transaction_delay": 3888000,\n    "max_inline_action_size": 4096,\n    "max_inline_action_depth": 6,\n    "max_authority_depth": 6\n  }\n}\n\n')),(0,r.kt)("h5",{id:"9-running-the-node"},"9. Running the Node:"),(0,r.kt)("p",null,"Once you are through the previous steps, the next step is to get started with the steps to run the node and sync with the WAX Mainnet/Testnet:"),(0,r.kt)("p",null,"You can start the ",(0,r.kt)("strong",{parentName:"p"},"nodeos")," using the command and parameters below:"),(0,r.kt)("p",null,"For starting the node from genesis:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"nodeos --disable-replay-opts --data-dir /home/data/ --config-dir /home/data/ --genesis-json=/home/conf/genesis.json\n")),(0,r.kt)("p",null,"For starting the node from a snapshot:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"nodeos --disable-replay-opts --data-dir /home/data/ --config-dir /home/data/ --snapshot /home/data/snapshots/<replace with snapshot file name>\n")),(0,r.kt)("h6",{id:"running-and-managing-nodeos-using-scripts"},"Running and managing nodeos using scripts:"),(0,r.kt)("p",null,"The below start and stop scripts will help you to daemonize and manage the nodeos service."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"cd /home/conf\nvim start.sh\n")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"start.sh")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'#!/bin/bash\nDATADIR="/home/data"\n\n#change the directory path according to your configuration\nNODEOSBINDIR="/usr/opt/wax/2013wax01-mv/bin/" \n\n\n$DATADIR/stop.sh\necho -e "Starting Nodeos \\n";\n\nulimit -c unlimited\nulimit -n 65535\nulimit -s 64000\n\n$NODEOSBINDIR/nodeos/nodeos --data-dir $DATADIR --config-dir $DATADIR "$@" > $DATADIR/stdout.txt 2> $DATADIR/stderr.txt &  echo $! > $DATADIR/nodeos.pid\n')),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"stop.sh")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'#!/bin/bash\nDIR="/home/data"\n if [ -f $DIR"/nodeos.pid" ]; then\n        pid=`cat $DIR"/nodeos.pid"`\n        echo $pid\n        kill $pid\n\n\n        echo -ne "Stoping Nodeos"\n\n        while true; do\n            [ ! -d "/proc/$pid/fd" ] && break\n            echo -ne "."\n            sleep 1\n        done\n        rm -r $DIR"/nodeos.pid"\n\n        DATE=$(date -d "now" +\'%Y_%m_%d-%H_%M\')\n        if [ ! -d $DIR/logs ]; then\n            mkdir $DIR/logs\n        fi\n        tar -pcvzf $DIR/logs/stderr-$DATE.txt.tar.gz stderr.txt stdout.txt\n\n\n        echo -ne "\\rNodeos Stopped.    \\n"\n    fi\n')),(0,r.kt)("p",null,"All you have to do now is start the script and monitor the logs in stderr.txt in /home/data folder."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"tail -f stderr.tx\n")),(0,r.kt)("p",null,"Your State-History node will now start syncing with the configured peers and catch-up with the chain headblock. It may take up to 2-3 weeks for a complete block sync from genesis for WAX Mainnet. It may also help if you choose a few closely located peers to limit peer overload and ensure low latency."),(0,r.kt)("p",null,"Example screenshot when the node is syncing successfully:"),(0,r.kt)("p",null,(0,r.kt)("img",{parentName:"p",src:"https://user-images.githubusercontent.com/15923938/163224549-92f633fc-6ab5-4a15-adee-fe165ece874b.png",alt:"image"})),(0,r.kt)("p",null,"As your node syncs from the start of the chain it will build the log and index files in the /blocks and /state-history directories in your /home/data folder."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"You can now query the node rest endpoint at http port 8888 and for websockets it is port 8080")))}u.isMDXComponent=!0}}]);